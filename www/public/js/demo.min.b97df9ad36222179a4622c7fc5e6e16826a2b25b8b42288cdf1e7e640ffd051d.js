window.addEventListener("DOMContentLoaded",()=>{"use strict";const i=document.querySelector("dialog"),e=document.querySelector("x-keyboard"),t=document.querySelector("input"),s=document.querySelector(".keyboard select"),n=document.querySelector(".keyboard button");if(!e.layout){console.warn("web components are not supported");return}const a=()=>s.value.split(" ")[1];fetch(e.getAttribute("src")).then(e=>e.json()).then(t=>{const o=a();e.setKeyboardLayout(t.keymap,t.deadkeys,o),s.value=o,n&&(n.hidden=!1)}),s.addEventListener("change",t=>{e.geometry=a()}),n&&(n.onclick=()=>{i?.showModal(),t.value="",t.focus()}),t.onblur=()=>{e.clearStyle(),i?.close()};const o={};t.onkeydown=t=>{o[t.code]=!0;const n=e.keyDown(t);if(t.code==="Enter")t.target.value="";else if(n)t.target.value+=n;else return!0;return!1},t.addEventListener("keyup",t=>{o[t.code]?(e.keyUp(t),delete o[t.code]):(t.target.value+=e.keyDown(t),setTimeout(()=>e.keyUp(t),100))}),t.addEventListener("input",e=>{(e.inputType==="insertCompositionText"||e.inputType==="insertText")&&(e.target.value=e.target.value.slice(0,-e.data.length))})})